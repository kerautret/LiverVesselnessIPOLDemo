<%include file="header.html" />

<META NAME="Author" CONTENT="JSC3D">

  <body >




<p>
  %if  app.cfg['param']['methodname'] != 'RORPO_multiscale_usage' :
  The algorithm result obtained with the method <i><font color="blue" > ${app.cfg['param']['methodname']}</font></i> is displayed hereafter.
  %else:
  The algorithm result obtained with the method <i><font color="blue" >RORPO</font></i> is displayed hereafter.
  %endif
  The result was obtained in <font color="darkred">${"{:,.3f}".format(app.cfg['info']['run_time'])} sec </font>.
</p>
<p>
  The result was obtained by the following scale parameters (displayed on  <i><font color="blue">
%if app.cfg['param']['masktypedisplay'] == "dilatedmask" :
 dilated vessel mask</font></i>).
%elif app.cfg['param']['masktypedisplay'] == "livermask" :
 liver mask </font></i>).
%elif app.cfg['param']['masktypedisplay'] == "bifurcation" :
 vessel bifurcation mask</font></i>).
%else:
no mask</font></i>).
%endif

  <ul>
  %if  app.cfg['param']['methodname'] != 'RORPO_multiscale_usage' :
  <li>  <label for="sigmamin"> <font color=blue><i>sigma min</i></font>: ${app.cfg['param']['sigmamin']}</label></li>
  <li>  <label for="sigmamax"> <font color=blue><i>sigma max</i></font>: ${app.cfg['param']['sigmamax']}</label></li>
  <li>  <label for="steps"> <font color=blue><i>steps</i></font>: ${app.cfg['param']['steps']}</label></li>
  %else:
  <li> <label for="scaleminrorpo"> <font color=blue><i>scaleMinRORPO</i></font>: ${app.cfg['param']['scaleminrorpo']}</label></li>
  <li> <label for="factorrorpo"> <font color=blue><i>factorRORPO</i></font>: ${app.cfg['param']['factorrorpo']}</label> </li>
  <li><label for="nbscalerorpo"> <font color=blue><i>nbScaleRORPO</i></font>: ${app.cfg['param']['nbscalerorpo']}</label></li>
  <li><label for="dilatationrorpo"> <font color=blue><i>dilatationRORPO</i></font>: ${app.cfg['param']['dilatationrorpo']}</label></li>
  </ul>
  %endif
  </p>
  %if  app.cfg['param']['methodname'] == 'Antiga' :
  <p>And specific <i><font color="blue" > ${app.cfg['param']['methodname']}</font></i>  parameters:
  <ul>
    <li> <label for="alpha"> <font color=blue><i>alpha</i></font>:${app.cfg['param']['alpha']}</label></li>
    <li> <label for="beta"> <font color=blue><i>beta</i></font>:${app.cfg['param']['beta']}</label></li>
    <li> <label for="gamma"> <font color=blue><i>gamma</i></font>:${app.cfg['param']['gamma']}</label></li>
  </ul>
 </p> 
  %elif  app.cfg['param']['methodname'] == 'Jerman' or app.cfg['param']['methodname'] == 'RuiZhang'   :
  <p>And specific <i><font color="blue" > ${app.cfg['param']['methodname']}</font></i>  parameters:
    <ul>
         <label for="tau"> <font color=blue><i>tau</i></font>: ${app.cfg['param']['tau']}</label>
  </ul>
 </p> 
  %elif  app.cfg['param']['methodname'] == 'OOF'   :
  <p>And specific <i><font color="blue" > ${app.cfg['param']['methodname']}</font></i>  parameters:
    <ul>
      <label for="sigmaoof"> <font color=blue><i>sigmaOOF</i></font>:  ${app.cfg['param']['sigmaoof']}</label>
  </ul>
 </p>
  %elif  app.cfg['param']['methodname'] == 'Sato'   :
  <p>And specific <i><font color="blue" > ${app.cfg['param']['methodname']}</font></i>  parameters:
    <ul>
      <label for="alpha1sato"> <font color=blue><i>alpha1Sato</i></font>:  ${app.cfg['param']['alpha1sato']}</label>
      <label for="alpha2sato"> <font color=blue><i>alpha1Sato</i></font>:  ${app.cfg['param']['alpha1sato']}</label>
    </ul>
 </p>

  
  %endif

  <ul>
    
<form action="${app.base_url + 'params'}" method="get">
  <div class="action">
    Restart this algorithm with new parameters.
    <input type="hidden" name="key" value="${app.key}">
    <input type="hidden" name="newrun" value="1">
    <input type="submit" value="new parameters" />
  </div>
</form>


<h2>Result</h2>
In addition to the 3D visualisation, you can download the result in <a href="${app.work_url + 'res.nii'}">.nii</a> format or download the reference mesh  <a href="${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/ref.obj'}"> .obj</a> of <a href="${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/'+app.refName+'.off'}">.off</a> format.  You can also check the input: <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/patientIso.nii'}"> here</a>



  <div style="position: relative;float: center; display: flex;
  justify-content: center;
  align-items: center;">

    <div id="visuVol"
         style="border: 2px solid gray;"
       class="itk-vtk-viewer"
         data-viewport="650x400"
        data-background-color="ffffFF"
       data-url="${app.work_url + 'res.nii'},${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/'+app.refName+'.off'}"      
      />
  <script type="text/javascript" src="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/itkVtkViewerCDN.js"></script>
   </div>
</div>


<br>


  
<p>The source images are illustrated on following menu (just click on the menu link on the left to load 3D viewer) : </p>


<div id="image3d" class="gallery" style="height:${560}px">
    <ul class="index">
      %if app.cfg['param']['masktypedisplay'] == "livermask" and  app.baseName[2:6] == "irca" :
      <li>
        <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/maskedLiverIso.nii'}">Input masked image          
	  <span>
              %if app.cfg['param']['masktypedisplay'] == "nomask" :
                 <img width="${460}px" src="${app.work_url + 'input_0_selection.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "livermask" :
                 <img width="${460}px" src="${app.work_url + 'input_0MaskLiver.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "dilatedmask" :
                 <img width="${460}px"  src="${app.work_url + 'input_0MaskVessel.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "bifurcation" :
                 <img width="${460}px"  src="${app.work_url + 'input_0MaskBifurcations.png'}" width="400" />
                 %endif
            </span>
      </a>
    </li>
   %endif

      %if app.cfg['param']['masktypedisplay'] == "dilatedmask"  :
      <li>
        <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/patientIsoMaskedVessel.nii'}">Input masked image          
	  <span>
              %if app.cfg['param']['masktypedisplay'] == "nomask" :
                 <img width="${460}px" src="${app.work_url + 'input_0_selection.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "livermask" :
                 <img width="${460}px" src="${app.work_url + 'input_0MaskLiver.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "dilatedmask" :
                 <img width="${460}px"  src="${app.work_url + 'input_0MaskVessel.png'}" width="400" />
                 %elif app.cfg['param']['masktypedisplay'] == "bifurcation" :
                 <img width="${460}px"  src="${app.work_url + 'input_0MaskBifurcations.png'}" width="400" />
                 %endif
            </span>
      </a>
    </li>
   %endif
      
      <li>
        %if app.cfg['param']['masktypedisplay'] == "livermask" and  app.baseName[2:6] == "irca" :
        <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/patientIso.nii'}">Non masked source	  
       %else:
          <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/patientIso.nii'}">Input image 
       %endif
	    <span>
                  <img width="${460}px" src="${app.work_url + 'input_0_selection.png'}" width="400" />
	</span>
      </a>
      </li>
      
 <li>
%if app.baseName[2:6] == "irca":
<a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/vesselsIso.nii'}"> ground truth
%else:
    <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/gt.nii'}"> ground truth
 %endif    
      <span>
        %if app.cfg['param']['masktypedisplay'] == "livermask" :
         <img width="${460}px" src="${app.work_url+'/'+'input_RefLiver.png'}" width="400" />
         %else:
         <img width="${460}px" src="${app.work_url+'/'+ 'input_Ref.png'}" width="400" />
         %endif

         
      </span>
      </a>
      </li>
  <li>
        %if app.cfg['param']['masktypedisplay'] != "livermask" or  app.baseName[2:6] != "irca" :
        <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/patientIso.nii'},${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/'+app.refName+'.off'}">Input image + ground truth
          %elif app.cfg['param']['masktypedisplay'] == "livermask" :
        <a href="http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/itk-vtk-viewer/dist/index.html?fileToLoad=${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/maskedLiverIso.nii'},${'http://ipol-geometry.loria.fr/SourceCodeDemosWorkshop/InputLiverDemo/Data/'+app.baseName +'/'+app.refName+'.off'}">Input masked image + ground truth
          
          %endif
	  <span>
        %if app.cfg['param']['masktypedisplay'] == "livermask" :
         <img width="${460}px" src="${app.work_url+'/'+'input_RefLiverInput.png'}" width="400" />
         %else:
         <img width="${460}px" src="${app.work_url+'/'+ 'input_RefInput.png'}" width="400" />
         %endif
	</span>
      </a>
  </li>
   
</ul>
</div>    



<h2>
  <a class="toggle" href="#commands" onclick="toggle('commands');">
    Additional Info
  </a>
</h2>
<div id="commands" style="display:none">
<p>
The algorithm ran with the following commands:
<pre class="stdio"> ${app.list_commands} </pre>
</p>
</div>

<%include file="footer.html" />
<%include file="archive_info.html" />
</body>
